# Dockerfile for Rust Backend

# Stage 1: Build the application
FROM rust:1.79 as builder

# Create a new empty shell project
WORKDIR /usr/src/volleyapp
COPY ./backend .

# Build the application
RUN cargo install --path .

# Stage 2: Create a minimal production image
FROM gcr.io/distroless/cc-debian12
COPY --from=builder /usr/local/cargo/bin/volleyapp /usr/local/bin/volleyapp

# Set the entrypoint
ENTRYPOINT ["/usr/local/bin/volleyapp"] 